================================================================================
ISSUE TRACKER: ORGANIZED BY SEVERITY & SECTION
================================================================================

Generated from: /Users/dylanchidambaram/Documents/Software/triviape/docs/CODEBASE_ANALYSIS.md
Total Issues: 82

================================================================================
ðŸš¨ CRITICAL ISSUES (25 TOTAL)
================================================================================

SECTION 1: API Routes & HTTP Handling
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1.2  | Hard-coded Bearer Token in /api/user/profile
     | File: app/api/user/profile/route.ts:7,54
     | Impact: PRODUCTION TEST CODE EXPOSED
     | Description: Production code contains hard-coded test Bearer token
     |   'Bearer expired-token'. Returns mock test data unrelated to caller.
     |   Not using middleware auth.
     | Fix: Remove test token check. Use proper auth middleware.
     | Effort: < 1 hour

1.10 | No Standard Response Format (Blocks API stability)
     | File: All API routes
     | Impact: CRITICAL FOR CLIENT RELIABILITY
     | Description: Clients must handle 4 different response formats. Makes
     |   error handling fragile and API unpredictable.
     | Fix: Create response wrapper function, apply to all routes.
     | Effort: 3-4 hours (includes all routes)
     | Dependencies: 1.2, 1.4, 1.5

SECTION 2: Component State Management
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2.3  | Authentication State Fragmentation
     | Files: useAuth.ts, SessionProvider, /api/user/profile
     | Impact: BREAKS AUTH ACROSS LAYERS
     | Description: Three sources of truth for user identity:
     |   - Firebase useAuth() uses .uid
     |   - NextAuth uses .id
     |   - Bearer token (hard-coded test values)
     |   Causes type mismatch bugs throughout codebase.
     | Fix: Choose ONE auth system (NextAuth recommended), remove others.
     | Effort: 5-7 hours
     | Blocks: Multiple auth consolidation

SECTION 3: Database Schema & Queries
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
3.1  | N+1 Query in FriendService.getFriends()
     | File: app/lib/services/friendService.ts:196-251
     | Impact: FRIENDS FEATURE UNUSABLE AT SCALE
     | Description: Gets friendships (1 query) then:
     |   - Individual getDoc for each friend (100 queries)
     |   - Mutual friends count for each (100 queries)
     |   - Online status for each (100 queries)
     |   With 100 friends: 301 queries instead of ~3
     | Cost: 99% query reduction possible
     | Fix: Batch load with 'in' operator (10 at a time).
     | Effort: 2-3 hours
     | Blocks: 3.2, 3.3

3.2  | Friend Activity 'in' Operator Limit
     | File: app/lib/services/friendService.ts:413-437
     | Impact: SILENT DATA LOSS >10 FRIENDS
     | Description: Firestore 'in' operator limited to 10 items.
     |   With >10 friends, query silently fails for rest.
     |   No error thrown. Users with >10 friends miss activity.
     | Example: User with 25 friends only sees activity from first 10.
     | Fix: Batch load in groups of 10.
     | Effort: 1-2 hours
     | Blocked by: 3.1

3.3  | N+1 in User Search
     | File: app/lib/services/friendService.ts:257-306
     | Impact: SEARCH EXTREMELY SLOW
     | Description: For 20-user search result:
     |   - Search query (1)
     |   - Current user friends (1)
     |   - Pending requests (1)
     |   - Mutual friends for each result (20 queries)
     |   = 23+ queries per search
     | Fix: Batch mutual friends calculation.
     | Effort: 2 hours
     | Blocked by: 3.1

3.4  | Inefficient Leaderboard Rank Calculation
     | File: app/lib/services/leaderboardService.ts:549-559
     | Impact: RANK UPDATES O(N) COST
     | Description: Queries ALL documents with higher scores.
     |   At 1000 leaderboard entries: 1000+ documents scanned per submission.
     | Fix: Store rank directly, update on leaderboard changes.
     | Effort: 2-3 hours
     | Dependencies: Query batching patterns from 3.1

SECTION 4: Performance & Monitoring
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4.1  | Production Metrics Export Disabled
     | File: app/lib/performanceAnalyzer.ts:72-74
     | Impact: NO PRODUCTION VISIBILITY
     | Description: Code to send metrics to analytics is commented out.
     |   Web Vitals + network tracking gated behind dev-only showDashboard.
     |   Production metrics remain in-memory, lost on page reload.
     | Status: Incomplete implementation
     | Fix: Uncomment and implement sendToAnalyticsService(). Choose
     |   backend (Firebase Analytics, DataDog, etc).
     | Effort: 2-3 hours
     | Blocks: Production observability

4.2  | Memory Leak in useBenchmark Frame Tracking
     | File: app/hooks/performance/useBenchmark.ts:74
     | Impact: UNBOUNDED MEMORY GROWTH
     | Description: Frame timing array grows unbounded.
     |   At 60fps: 60 entries/second added.
     |   Component visible 5 minutes = 18,000 array entries.
     |   Multiple components = 3x+ memory overhead.
     |   Array never cleared.
     | Fix: Clear framesRef.current in cleanup, or store only recent frames.
     | Effort: 30 minutes
     | Blocks: 4.3 (RiveAnimation production impact)

4.3  | useBenchmark Runs in Production for RiveAnimation
     | Files: app/components/animation/rive-animation.tsx:55-68
     |         app/hooks/performance/useBenchmark.ts:34-36
     | Impact: MEMORY LEAK IN PRODUCTION
     | Description: useBenchmark defaults to enabled=true.
     |   Rive animations run this in PRODUCTION, not just dev.
     |   Combined with unbounded frame array (Issue 4.2), this is prod risk.
     | Fix: Add enabled=false default or gate to dev-only.
     | Effort: 30 minutes
     | Blocked by: 4.2

SECTION 5: Testing & Quality
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
5.1  | Over-Mocking Tests
     | File: app/__tests__/hooks/useAuth.test.ts, auth-api.test.ts
     | Impact: TESTS TEST MOCKS, NOT CODE
     | Description: Hooks mocked at module level in their own tests.
     |   AuthProvider mocked in its own test.
     |   Tests verify mock behavior, not real code.
     |   Defeats testing purpose. False confidence.
     | Fix: Remove mocks, use real implementations.
     | Effort: 4-6 hours
     | Blocks: 5.4, test reliability

5.3  | Tests Skipped in CI
     | Files: app/__tests__/api/auth-api.test.ts:75
     |         app/__tests__/security/api-protection.test.ts:61
     | Impact: CRITICAL TESTS NEVER RUN
     | Description: itIfEmulatorsRunning skips based on process.env.CI,
     |   not actual emulator availability. Integration tests don't run
     |   in CI by default. Emulator startup failures logged but tests continue.
     | Fix: Actually run integration tests in CI with emulator setup.
     | Effort: 2-3 hours
     | Depends on: 5.4, emulator setup

5.4  | Emulator Tests Never Touch Real Firebase
     | Files: jest.setup.ts, firebase-test-utils.ts
     | Impact: NO REAL INTEGRATION TESTING
     | Description: Global Firebase mocks in jest.setup.ts.
     |   createTestUser() and signInTestUser() return mock users.
     |   Emulator runs but code never uses it.
     |   'Integration' tests are actually mock-only tests.
     | Fix: Remove module-level Firebase mocks. Use real Firebase in tests.
     | Effort: 6-8 hours
     | Blocks: 5.1, 5.3, test confidence

SECTION 6: Security
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
6.1  | Test/Diagnostic Auth Endpoints Exposed
     | Files: app/api/auth/test-login/route.ts:9
     |         app/api/auth/test-signin/route.ts:9
     |         app/api/auth/test-signup/route.ts:9
     |         app/api/auth/diagnostics/route.ts:8
     |         app/api/auth/create-test-account/route.ts:11
     | Impact: PUBLIC CAN PROBE AUTH SYSTEM
     | Description: No environment guards on test-login, test-signin,
     |   test-signup, diagnostics. create-test-account only blocks in
     |   production (open in staging/dev). Public callers can:
     |   - Create/delete users
     |   - Probe auth behavior
     |   - Pull server diagnostics
     | Fix: Remove from production or add strict NODE_ENV checks.
     | Effort: < 1 hour
     | Blocks: Security hardening

6.2  | Hard-coded Bearer Token + Mock Profile
     | File: app/api/user/profile/route.ts:7,54
     | Impact: AUTH BYPASS
     | Description: Production code has hard-coded 'Bearer expired-token'
     |   that returns fixed test data (test-user-id, test user profile).
     |   Endpoint returns data unrelated to caller.
     | Fix: Remove. Use proper auth middleware.
     | Effort: < 1 hour
     | Same as issue 1.2

SECTION 7: Build & Deployment
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
7.1  | Two Build Config Files Exist
     | Files: next.config.ts, next.config.js
     | Impact: CONFIGURATION DRIFT
     | Description: Both files present with different configs.
     |   next.config.js has typescript.ignoreBuildErrors: true
     |   next.config.ts missing it.
     |   Unclear which Next.js loads (usually .js takes precedence).
     |   Different settings will cause unexpected behavior.
     | Fix: Choose one, delete the other.
     | Effort: 1 hour (but important decision)
     | Blocks: 7.2

7.2  | ignoreBuildErrors in Build Config
     | File: next.config.js:3782
     | Impact: TYPE ERRORS CAN SHIP
     | Description: typescript.ignoreBuildErrors: true allows production
     |   builds to succeed with type errors. Defeats TypeScript purpose.
     |   Broken code can be deployed.
     | Fix: Remove this setting. Enforce type checking.
     | Effort: < 1 hour
     | Blocks: 7.3, 7.4 (CI checks)

7.3  | No Pre-Deploy Tests
     | Files: firebase-hosting-merge.yml, firebase-hosting-pull-request.yml
     | Impact: NO QUALITY GATES
     | Description: GitHub Actions workflows don't run tests before
     |   deployment. No linting. No type checking. Broken code can be
     |   deployed to production.
     | Fix: Add test step, type check, linting to CI pipeline.
     | Effort: 2-3 hours
     | Depends on: 7.2 (remove ignoreBuildErrors)
     | Blocks: Reliable deployments

7.4  | Missing Build Step in CI
     | File: firebase-hosting-merge.yml
     | Impact: BUILD OUTPUT NOT GENERATED
     | Description: Merge workflow runs 'npm ci' but no 'npm run build'.
     |   firebase.json has no predeploy hooks.
     |   hosting.public: "build" is never generated in CI.
     |   Deploying empty or stale build directory.
     | Fix: Add 'npm run build' before firebase deploy.
     | Effort: < 1 hour
     | Blocks: Deployments work at all

================================================================================
ðŸŸ  HIGH PRIORITY ISSUES (25 TOTAL)
================================================================================

SECTION 1: API Routes & HTTP Handling
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1.1  | Response Format Inconsistency (Complements 1.10)
1.3  | Authentication Fragmentation (Multiple Systems)
1.4  | Input Validation Inconsistency (Partial, No Validation)
1.5  | Error Handling Patterns (Multiple Formats)
1.6  | Rate Limiting Missing on User/Public Endpoints

SECTION 2: Component State Management
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2.1  | Provider Nesting Complexity (5 Providers, Hydration Issues)
2.2  | React Query Usage Inconsistency (Config Varies 30min-24h)
2.4  | Firebase Real-time Listener Sync Issues (Race Conditions)
2.5  | Cache Invalidation Chaos (3 Different Patterns)
2.6  | localStorage as Cache Layer (Bypasses React Query)

SECTION 3: Database Schema & Queries
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
3.5  | Missing Firestore Composite Indexes (Only 2, Need 8+)
3.6  | Denormalized User Data (4+ Locations, Stale Data Risk)
3.7  | No Query Result Caching (Repeated Fetches)
3.10 | Incomplete Firestore Security Rules (Missing Collections)

SECTION 4: Performance & Monitoring
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4.4  | Incomplete Web Vitals Coverage (Missing INP, TTFB)
4.6  | Monitoring Gated to Dev-Only (No Production Visibility)
4.7  | React Query Metrics Not Tracked (Infrastructure Built, No Data)
4.19 | startMeasurement Called Without Category (Unreliable Reporting)

SECTION 5: Testing & Quality
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
5.5  | API Tests Mock Firebase Admin (Even with Emulator)
5.6  | Emulator Detection Broken by fetch Mock (jest.setup.ts Issue)
5.7  | Security Tests Mock NextRequest/NextResponse (Real Behavior Not Tested)
5.8  | Test Data Not Isolated (Module-Scoped, Shared Across Tests)
5.9  | No Coverage Thresholds Enforced (Optional, Not CI Gated)

SECTION 6: Security
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
6.3  | Debug/Test UI Routes Unguarded (/test/* No Checks)
6.4  | NextAuth Logs User Emails (Sensitive Data Leak Risk)
6.5  | NextAuth Returns Distinct Auth Errors (Email Enumeration)
6.6  | Security Middleware Not Wired (Defined But Inactive)
6.7  | CSP Too Permissive (unsafe-inline, unsafe-eval)

SECTION 7: Build & Deployment
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
7.5  | No Node Version Pinned (Uses Default, Can Drift)
7.6  | Overly Permissive Image Config (Any HTTPS Domain)
7.7  | Firebase Hosting Config Drift (Root vs firebase/ Configs)
7.8  | Type Check Not Integrated (Optional, Not In CI)
7.9  | build:no-types Script Misleading (Same as build)

================================================================================
ðŸŸ¡ MEDIUM PRIORITY ISSUES (25 TOTAL)
================================================================================

SECTION 1: API Routes & HTTP Handling
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1.7  | Request Tracing & Observability Gaps
1.8  | API Documentation Gaps
1.9  | Type Safety Issues (Untyped Results)

SECTION 2: Component State Management
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2.7  | Mock Data Baked into Production
2.8  | Prop Drilling Despite State Management
2.9  | Excessive Hydration Mismatch Prevention
2.10 | Performance Monitoring Overhead
2.11 | State Management Decision Tree Unclear

SECTION 3: Database Schema & Queries
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
3.8  | Real-time Listener Broadcasts All Presence
3.9  | No Cascade Delete on Quiz Removal

SECTION 4: Performance & Monitoring
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4.5  | Dynamic Import on Every Navigation
4.8  | Component Metrics Record Zero Values
4.9  | Redundant Monitoring Systems
4.10 | No Error Differentiation in Measurements
4.11 | Global Fetch Monkeypatching
4.12 | Web Vitals Re-Registered on Navigation
4.13 | PerformanceDashboard Uses Fake Data
4.14 | Misleading Slowest Components Summary
4.15 | Network Monitor Load Listener Not Removed
4.16 | Performance Dashboard Mounted Twice in Dev
4.17 | useMeasurePerformance autoLog Unused
4.18 | No Metrics Sampling or Rate Limiting

SECTION 5: Testing & Quality
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
5.10 | E2E Tests Are Brittle
5.11 | No Error Path Testing
5.12 | Performance Code Not Tested
5.13 | E2E Password Reset May Be Flaky
5.14 | No Proper Test Cleanup

SECTION 6: Security
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
6.8  | Public Quiz Endpoints Unauthenticated
6.9  | Firebase Admin Credentials Handling

SECTION 7: Build & Deployment
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
7.10 | Multiple Build Methods (Confusing Variants)
7.11 | Linting Not Integrated with Build/CI
7.12 | TypeScript Target Too Old (es5)
7.13 | skipLibCheck Enabled (Defeats Strict Mode)
7.14 | Documentation Auto-Commits (No Approval)
7.15 | No Rollback Capability
7.16 | Limited Error Handling in CI

================================================================================
QUICK REFERENCE: ISSUES BY FIXES NEEDED
================================================================================

IMMEDIATE QUICK FIXES (< 1 hour each):
- 1.2: Remove Bearer token check
- 6.1: Add NODE_ENV guards to test endpoints
- 6.2: Remove mock profile response
- 7.2: Remove ignoreBuildErrors
- 7.4: Add npm run build to CI
- 4.2: Clear frame array in cleanup

CORE REFACTORS (4-8 hours each):
- 1.3/2.3: Consolidate auth systems
- 3.1-3.4: Implement batch loading patterns
- 5.4: Remove Firebase mocks from tests
- 7.1: Choose one build config

FEATURE ADDITIONS (2-4 hours each):
- 4.1: Enable production metrics export
- 1.6: Add rate limiting middleware
- 3.5: Add Firestore composite indexes
- 5.3: Integrate tests into CI

MAJOR REFACTORS (5+ hours each):
- 2.1-2.7: Redesign state management
- 5.1: Remove test mocks throughout
- 7.3: Add quality gates to pipeline

================================================================================
PRIORITIZED EXECUTION TIMELINE
================================================================================

WEEK 1 (CRITICAL FIXES):
Monday:   1.2, 6.1, 6.2, 7.2, 7.4
Tuesday:  4.2, 4.3, 7.3 (partial - add basic checks)
Wed-Fri:  1.3/2.3 (auth consolidation start)

WEEK 2 (ARCHITECTURE):
- Complete auth consolidation (1.3, 2.3)
- Implement batch loading (3.1-3.4)
- Standardize API responses (1.1, 1.4, 1.5)

WEEK 3 (QUALITY):
- Fix test issues (5.1, 5.4, 5.3)
- Add CI checks (7.3, 7.8, 7.11)
- Performance fixes (4.1, 4.2, 4.3)

WEEK 4-5:
- State management refactor (2.1-2.7)
- Database optimization (3.5-3.10)
- Security hardening (6.3-6.9)

================================================================================
END OF DETAILED BREAKDOWN
================================================================================
